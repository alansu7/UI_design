<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>åŸ¹è®­ç³»ç»Ÿ</title>
  <style>
    body {
      margin: 0;
      font-family: "Microsoft YaHei", sans-serif;
      background: linear-gradient(135deg, #0a0f24, #1e2b50);
      color: #e0e0e0;
    }
    h1 {
      text-align: center;
      font-size: 36px;
      color: #00bfff;
      margin: 24px 0 10px;
    }
    .login-container {
      text-align: center;
      margin: 20px 0;
    }
    .login-container input,
    .login-container select,
    .login-container button {
      margin: 6px;
      padding: 6px 10px;
      border-radius: 6px;
      border: none;
      font-size: 16px;
    }
    .login-container button {
      background-color: #3a66b3;
      color: white;
      cursor: pointer;
    }
    .app {
      display: none;
      justify-content: space-between;
      padding: 30px 60px;
    }
    .panel {
      width: 45%;
      display: flex;
      flex-direction: column;
    }
    .card {
      background: linear-gradient(135deg, #1f3b8d, #3a66b3);
      color: #fff;
      padding: 16px 24px;
      margin-bottom: 16px;
      text-align: left;
      cursor: pointer;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
      border: 1px solid rgba(255,255,255,0.1);
      backdrop-filter: blur(6px);
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .card:hover {
      transform: scale(1.03);
      box-shadow: 0 0 18px rgba(58,166,255,0.6);
    }
    .right-panel {
      width: 50%;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .progress-circle {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      background: conic-gradient(#ddd 0deg, #ddd 0deg);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      margin-bottom: 30px;
      transition: background 0.3s ease;
    }
    .progress-circle span {
      position: absolute;
      font-size: 22px;
      font-weight: bold;
      color: #000;
    }
    .training {
      background: rgba(255, 255, 255, 0.1);
      padding: 24px;
      border-radius: 10px;
      width: 100%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      font-size: 16px;
      line-height: 1.6;
      backdrop-filter: blur(10px);
    }
    .training h3 {
      margin-top: 0;
      font-size: 18px;
      color: #fff;
    }
    #ai-button {
      padding: 8px 16px;
      background-color: #3a66b3;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 16px;
    }
    #ai-result {
      margin-top: 12px;
      font-style: italic;
      color: #fff;
    }
    .dropdown {
      position: relative;
    }
    .dropdown-content {
      display: none;
      flex-direction: column;
      gap: 10px;
      margin-top: 8px;
    }
    .dropdown.open .dropdown-content {
      display: flex;
    }
  </style>
</head>
<body>

  <h1>åŸ¹è®­ç³»ç»Ÿ</h1>
  <div id="back-btn" style="text-align: right; padding: 0 40px; display: none;">
    <button onclick="goBack()" style="background-color: #555; color: white; padding: 6px 14px; border: none; border-radius: 6px; cursor: pointer;">
      â¬… è¿”å›ç™»å½•
    </button>
  </div>

  <div class="login-container">
    <input type="text" id="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" />
    <select id="role">
      <option value="é¡¹ç›®ç»ç†">é¡¹ç›®ç»ç†</option>
      <option value="æ–½å·¥å‘˜">æ–½å·¥å‘˜</option>
      <option value="æŠ€æœ¯å‘˜">æŠ€æœ¯å‘˜</option>
      <option value="å®‰å…¨å‘˜">å®‰å…¨å‘˜</option>
      <option value="AåŒºç­ç»„é•¿">AåŒºç­ç»„é•¿</option>
      <option value="BåŒºç­ç»„é•¿">BåŒºç­ç»„é•¿</option>
      <option value="CåŒºç­ç»„é•¿">CåŒºç­ç»„é•¿</option>
      <option value="DåŒºç­ç»„é•¿">DåŒºç­ç»„é•¿</option>
      <option value="EåŒºç­ç»„é•¿">EåŒºç­ç»„é•¿</option>
    </select>
    <button onclick="login()">ç™»å½•</button>
  </div>

  <div class="app" id="app">
    <div class="panel" id="left-panel"></div>

    <div class="right-panel">
      <div class="progress-circle" id="progress-circle">
        <span id="progress-value">0%</span>
      </div>
      <div class="training" id="training-content">
        ç‚¹å‡»å·¦ä¾§è§’è‰²æŸ¥çœ‹èµ„æ ¼åŒ¹é…åº¦å’ŒåŸ¹è®­å†…å®¹ã€‚
        <div>
          <button id="ai-button" onclick="generateAI()">ğŸ§  è·å– AI ä¸ªæ€§åŒ–æ¨è</button>
        </div>
        <div id="ai-result"></div>
      </div>
    </div>
  </div>

  <script>
    const allRoles = [
      { id: 'é¡¹ç›®ç»ç†', label: 'ğŸ‘¨â€ğŸ’¼ é¡¹ç›®ç»ç†' },
      { id: 'æ–½å·¥å‘˜', label: 'ğŸ› ï¸ æ–½å·¥å‘˜' },
      { id: 'æŠ€æœ¯å‘˜', label: 'ğŸ§° æŠ€æœ¯å‘˜' },
      { id: 'å®‰å…¨å‘˜', label: 'ğŸ¦º å®‰å…¨å‘˜' },
      { id: 'AåŒºç­ç»„é•¿', label: 'ğŸ—ï¸ AåŒºç­ç»„é•¿' },
      { id: 'BåŒºç­ç»„é•¿', label: 'ğŸ—ï¸ BåŒºç­ç»„é•¿' },
      { id: 'CåŒºç­ç»„é•¿', label: 'ğŸ—ï¸ CåŒºç­ç»„é•¿' },
      { id: 'DåŒºç­ç»„é•¿', label: 'ğŸ—ï¸ DåŒºç­ç»„é•¿' },
      { id: 'EåŒºç­ç»„é•¿', label: 'ğŸ—ï¸ EåŒºç­ç»„é•¿' }
    ];

    const mockData = {
      "é¡¹ç›®ç»ç†": { percent: 85, training: "é«˜çº§é¡¹ç›®ç®¡ç†ç­–ç•¥ã€è·¨éƒ¨é—¨åè°ƒèƒ½åŠ›æå‡ã€é£é™©é¢„æ§æŠ€æœ¯" },
      "æ–½å·¥å‘˜": { percent: 40, training: "æ–½å·¥æµç¨‹ä¼˜åŒ–ã€æ“ä½œè§„èŒƒæ ‡å‡†ã€å®‰å…¨ä½œä¸šç®¡ç†" },
      "æŠ€æœ¯å‘˜": { percent: 70, training: "è®¾å¤‡è°ƒè¯•ä¸ç»´æŠ¤ã€è´¨é‡æ£€æŸ¥æµç¨‹ã€å›¾çº¸è¯†è¯»" },
      "å®‰å…¨å‘˜": { percent: 55, training: "å®‰å…¨æ£€æŸ¥æµç¨‹ã€åº”æ€¥é¢„æ¡ˆç¼–å†™ã€ç°åœºéšæ‚£è¯†åˆ«" },
      "AåŒºç­ç»„é•¿": { percent: 50, training: "åŒºåŸŸåè°ƒèƒ½åŠ›ã€äººå‘˜ç®¡ç†ã€ä»»åŠ¡åˆ†é…" },
      "BåŒºç­ç»„é•¿": { percent: 45, training: "ç°åœºæ²Ÿé€šæŠ€å·§ã€å›¢é˜Ÿåä½œã€å®‰å…¨ç”Ÿäº§æµç¨‹" },
      "CåŒºç­ç»„é•¿": { percent: 60, training: "CåŒºä»»åŠ¡å¯¹æ¥æµç¨‹ã€äº¤ä»˜æ ‡å‡†ã€è´¨é‡è´£ä»»åˆ¶" },
      "DåŒºç­ç»„é•¿": { percent: 35, training: "DåŒºæ’äº§è®¡åˆ’ååŒã€ç‰©æ–™è¿›åº¦åŒæ­¥" },
      "EåŒºç­ç»„é•¿": { percent: 78, training: "EåŒºå®‰å…¨ç¯å¢ƒç®¡ç†ã€ç°åœºåº”å˜èƒ½åŠ›" }
    };

    let currentRole = null;
    let loggedRole = null;

    function login() {
      const role = document.getElementById('role').value;
      const username = document.getElementById('username').value.trim();
      if (!username) return alert('è¯·è¾“å…¥ç”¨æˆ·å');
      loggedRole = role;
      document.querySelector('.login-container').style.display = 'none';
      document.getElementById('app').style.display = 'flex';
      document.getElementById("back-btn").style.display = "block"; // ğŸ‘ˆ æ˜¾ç¤ºè¿”å›æŒ‰é’®
      renderButtons();
    }

    function renderButtons() {
      const container = document.getElementById('left-panel');
      container.innerHTML = '';

      let visibleRoles = [];
      if (loggedRole === 'é¡¹ç›®ç»ç†') {
        visibleRoles = allRoles;
      } else if (['æ–½å·¥å‘˜', 'æŠ€æœ¯å‘˜', 'å®‰å…¨å‘˜'].includes(loggedRole)) {
        visibleRoles = allRoles.filter(r => [loggedRole, ...ç­ç»„é•¿()].includes(r.id));
      } else {
        visibleRoles = allRoles.filter(r => r.id === loggedRole);
      }

      const upper = visibleRoles.filter(r => !r.id.includes('ç­ç»„é•¿') || r.id === loggedRole);
      const foremen = visibleRoles.filter(r => ç­ç»„é•¿().includes(r.id));

      upper.forEach(role => {
        const div = document.createElement('div');
        div.className = 'card';
        div.textContent = role.label;
        div.onclick = () => showInfo(role.id);
        container.appendChild(div);
      });

      if (foremen.length && !loggedRole.includes('ç­ç»„é•¿')) {
        const wrap = document.createElement('div');
        wrap.className = 'dropdown';
        wrap.id = 'foreman-dropdown';

        const trigger = document.createElement('div');
        trigger.className = 'card';
        trigger.textContent = 'ğŸ“‹ ç­ç»„é•¿ â¬‡';
        trigger.onclick = () => wrap.classList.toggle('open');

        const content = document.createElement('div');
        content.className = 'dropdown-content';

        foremen.forEach(r => {
          const item = document.createElement('div');
          item.className = 'card';
          item.textContent = r.label;
          item.onclick = () => showInfo(r.id);
          content.appendChild(item);
        });

        wrap.appendChild(trigger);
        wrap.appendChild(content);
        container.appendChild(wrap);
      }
    }

    function ç­ç»„é•¿() {
      return ['AåŒºç­ç»„é•¿', 'BåŒºç­ç»„é•¿', 'CåŒºç­ç»„é•¿', 'DåŒºç­ç»„é•¿', 'EåŒºç­ç»„é•¿'];
    }

    function showInfo(role) {
      const { percent, training } = mockData[role] || { percent: 0, training: "æš‚æ— æ•°æ®" };
      currentRole = role;
      animateProgress(percent);
      const trainingEl = document.getElementById("training-content");
      trainingEl.querySelector("h3")?.remove();
      trainingEl.querySelector("p")?.remove();
      trainingEl.querySelector("#ai-result").innerText = "";
      trainingEl.insertAdjacentHTML("afterbegin", `<h3>${role} æ¨èåŸ¹è®­å†…å®¹</h3><p>${training}</p>`);
    }

    function animateProgress(targetPercent) {
      let current = 0;
      const steps = 30, duration = 800, increment = targetPercent / steps;
      const interval = duration / steps;

      const animate = setInterval(() => {
        current += increment;
        if (current >= targetPercent) {
          current = targetPercent;
          clearInterval(animate);
        }
        const deg = current * 3.6;
        const color = getColor(current);
        document.getElementById("progress-circle").style.background = `conic-gradient(${color} ${deg}deg, #ddd ${deg}deg)`;
        document.getElementById("progress-value").innerText = `${Math.round(current)}%`;
      }, interval);
    }

    function getColor(p) {
      if (p <= 50) return '#f44336';
      if (p <= 75) return '#ffc107';
      return '#4caf50';
    }

    function generateAI() {
      const aiBox = document.getElementById("ai-result");
      if (!currentRole) {
        aiBox.innerText = "è¯·å…ˆç‚¹å‡»ä¸€ä¸ªè§’è‰²ã€‚";
        return;
      }
      const ideas = [
        "ç»“åˆç°åœºæ¡ˆä¾‹æå‡å®æˆ˜èƒ½åŠ›ã€‚",
        "åŠ å…¥çº¿ä¸Šäº’åŠ¨é—®ç­”ï¼Œå·©å›ºçŸ¥è¯†ã€‚",
        "æ¨èä½ è¯•è¯•AIæ¨¡æ‹Ÿè®­ç»ƒå¹³å°ï¼Œä½“éªŒå¼å­¦ä¹ æ›´æœ‰æ•ˆã€‚",
        "å»ºè®®åŠ å¼ºå¿ƒç†å®‰å…¨ä¸é¢†å¯¼åŠ›è¯¾ç¨‹ã€‚",
        "ä¸ºä½ åŒ¹é…äº†è¡Œä¸šæœ€æ–°æ ‡å‡†å­¦ä¹ èµ„æ–™åŒ…ã€‚"
      ];
      aiBox.innerText = `ğŸ“Œ AIæ¨èï¼š${ideas[Math.floor(Math.random() * ideas.length)]}`;
    }

    function goBack() {
      document.getElementById("app").style.display = "none";
      document.querySelector(".login-container").style.display = "block";
      document.getElementById("back-btn").style.display = "none"; // ğŸ‘ˆ éšè—æŒ‰é’®
      document.getElementById("username").value = "";
      document.getElementById("role").value = "é¡¹ç›®ç»ç†";
      document.getElementById("left-panel").innerHTML = "";
      document.getElementById("training-content").innerHTML = `
        ç‚¹å‡»å·¦ä¾§è§’è‰²æŸ¥çœ‹èµ„æ ¼åŒ¹é…åº¦å’ŒåŸ¹è®­å†…å®¹ã€‚
        <div><button id="ai-button" onclick="generateAI()">ğŸ§  è·å– AI ä¸ªæ€§åŒ–æ¨è</button></div>
        <div id="ai-result"></div>
      `;
      document.getElementById("progress-circle").style.background = "conic-gradient(#ddd 0deg, #ddd 0deg)";
      document.getElementById("progress-value").innerText = "0%";
    }
  </script>
</body>
</html>
